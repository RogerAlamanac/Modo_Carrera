; * ROGER ALAMANAC, DANIEL CASAS, 2024 (ENTI-UB)

; **********************************
; DECLARACIO DE VARIABLES I TECLES
; **********************************

SGROUP 		GROUP 	CODE_SEG, DATA_SEG
			ASSUME 	CS:SGROUP, DS:SGROUP, SS:SGROUP

    TRUE  EQU 1
    FALSE EQU 0

; CONTROL DE LES BARRES
; JUGADOR 1
    ASCII_LEFT          EQU 04Bh 
    ASCII_RIGHT         EQU 04Dh
; JUGADOR 2
    ASCII_a              EQU 061h    ; VA CAP A L'ESQUERRA AMB LA 'a'
    ASCII_d              EQU 064h    ; VA CAP A LA DRETA AMB LA 'd'


; ASCII / ATRR CODES PER PINTAR LA BARRA DE JUGADOR 1
    ASCII_BARRA1        EQU 020h ; 020h es l'espai en blanc en hexadecimal del codi ascii per fer la barra 


; ASCII / ATTR PER PINTAR ELS LÍMITS DEL CAMP
    ASCII_FIELD         EQU 020h
    ATTR_FIELD          EQU 070h


; ASCII

 ASCII_YES_UPPERCASE      EQU 059h
    ASCII_YES_LOWERCASE      EQU 079h

; COLOREJAR DIMENSIONS DE LA PANTALLA EN NOMBRE DE CARACTERS
    SCREEN_MAX_ROWS EQU 25
    SCREEN_MAX_COLS EQU 80

; DIMENSIONS DEL CAMP
    FIELD_R1 EQU 1
    FIELD_R2 EQU SCREEN_MAX_ROWS-2
    FIELD_C1 EQU 1
    FIELD_C2 EQU SCREEN_MAX_COLS-2

;*************************
;  CODI EXECUTABLE (MAIN)
;*************************

CODE_SEG	SEGMENT PUBLIC
   ORG 100h; Indica on comença l'execució

MAIN 	PROC 	NEAR

    MAIN_GO:

      CALL INIT_GAME
      CALL INIT_SCREEN
      CALL HIDE_CURSOR
      CALL DRAW_FIELD

      MOV DH, SCREEN_MAX_ROWS/2
      MOV DL, SCREEN_MAX_COLS/2

    MAIN_LOOP

      CMP [END GAME], TRUE
      JZ END_PROG

      ; Comprovar si una tecla es pot llegir
      MOV AH, 0Bh
      INT 21h
      CMP AL, 0
      JZ MAIN_LOOP

      CALL READ_CHAR ; si hi ha tecla disponible, llegeix

      ; Comprovar si el joc s'acaba
      CMP AL, ASCII_QUIT
      JZ END_PROG

      ; Comprovar si es una tecla especial
      CMP AL, ASCII_SPECIAL_KEY
      JNZ MAIN_LOOP

      CALL READ_CHAR

      ;Començar el joc
      MOV [START_GAME], TRUE
      
 


   
